%{
    w(p, h) = d
%}
w=@(p, h) h*p ./ repmat((h*p)(3,:), 3, 1);
p=[
%290   490   490   290
%159   159   359   359
281.1662   516.9434   484.2327   262.9684
154.7470   136.7685   379.9645   379.7526
];
d=[
%298.45   470.77   492.46   314.33
%163.17   175.03   340.85   339.79
290   490   490   290
159   159   359   359
];

d=d-repmat(d(:,1), 1, 4);

A=[
p(1,1) p(2,1) 1 0      0      0 -p(1,1)*d(1,1) -p(2,1)*d(1,1) -d(1,1)
0      0      0 p(1,1) p(2,1) 1 -p(1,1)*d(2,1) -p(2,1)*d(2,1) -d(2,1)

p(1,2) p(2,2) 1 0      0      0 -p(1,2)*d(1,2) -p(2,2)*d(1,2) -d(1,2)
0      0      0 p(1,2) p(2,2) 1 -p(1,2)*d(2,2) -p(2,2)*d(2,2) -d(2,2)

p(1,3) p(2,3) 1 0      0      0 -p(1,3)*d(1,3) -p(2,3)*d(1,3) -d(1,3)
0      0      0 p(1,3) p(2,3) 1 -p(1,3)*d(2,3) -p(2,3)*d(2,3) -d(2,3)

p(1,4) p(2,4) 1 0      0      0 -p(1,4)*d(1,4) -p(2,4)*d(1,4) -d(1,4)
0      0      0 p(1,4) p(2,4) 1 -p(1,4)*d(2,4) -p(2,4)*d(2,4) -d(2,4)
];

[v, l] = eig(A'*A);

h=reshape(v(:,1)/v(9,1), [3 3])';
